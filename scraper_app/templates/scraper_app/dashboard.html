<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Scraper Dashboard</title>
    <style>
        body { font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; background-color: #f4f7f6; padding: 50px; text-align: center; }
        .container { background: white; padding: 40px; border-radius: 10px; box-shadow: 0 4px 6px rgba(0,0,0,0.1); max-width: 600px; margin: auto; }
        h1 { color: #333; }
        button { background-color: #4CAF50; color: white; padding: 15px 32px; font-size: 16px; border: none; border-radius: 5px; cursor: pointer; transition: 0.3s; }
        button:hover { background-color: #45a049; }
        #status { margin-top: 20px; font-weight: bold; color: #555; }
    </style>
</head>
<body>

<div class="container">
    <h1>ğŸš€ B2B æ•°æ®æŠ“å–æ§åˆ¶å°</h1>
    <p>ç‚¹å‡»ä¸‹æ–¹æŒ‰é’®ï¼Œç³»ç»Ÿå°†è‡ªåŠ¨åœ¨äº‘ç«¯æ‰§è¡Œçˆ¬è™«ä»»åŠ¡å¹¶ç”Ÿæˆæ•°æ®æŠ¥è¡¨ã€‚</p>
    
    <button id="scrapeBtn" onclick="startScraping()">å¼€å§‹æ‰§è¡ŒæŠ“å–ä»»åŠ¡</button>
    
    <div id="status"></div>
</div>

<script>
    // è¿™æ®µ JS çš„ä½œç”¨æ˜¯ä»£æ›¿ä½ æ‰‹åŠ¨åœ¨æµè§ˆå™¨è¾“å…¥ç½‘å€ï¼Œè®©æŒ‰é’®å»â€œæ•²æ‰“â€ä½ çš„ API
    function startScraping() {
        const btn = document.getElementById('scrapeBtn');
        const statusDiv = document.getElementById('status');
        
        // 1. æ”¹å˜æŒ‰é’®çŠ¶æ€ï¼Œç»™ç”¨æˆ·â€œæ­£åœ¨åŠ è½½â€çš„åé¦ˆ
        btn.disabled = true;
        btn.innerText = "æ•°æ®æŠ“å–ä¸­ï¼Œè¯·ç¨å€™...";
        statusDiv.innerText = "æ­£åœ¨è¿æ¥åå¨æœåŠ¡...";
        statusDiv.style.color = "blue";

        // 2. å‘ä½ çš„ Django API å‘èµ·è¯·æ±‚
        fetch('/api/scrape/')
            .then(response => response.json())
            .then(data => {
                // 3. æ‹¿åˆ°ç»“æœåï¼Œæ›´æ–°é¡µé¢æ˜¾ç¤º
                if(data.status === 'success') {
                    statusDiv.innerText = "âœ… æˆåŠŸï¼ç”Ÿæˆæ–‡ä»¶ï¼š" + data.file_generated;
                    statusDiv.style.color = "green";
                } else {
                    statusDiv.innerText = "âŒ å‘ç”Ÿé”™è¯¯ï¼š" + data.message;
                    statusDiv.style.color = "red";
                }
            })
            .catch(error => {
                statusDiv.innerText = "âŒ ç½‘ç»œè¯·æ±‚å¤±è´¥ï¼";
                statusDiv.style.color = "red";
            })
            .finally(() => {
                // 4. ä»»åŠ¡ç»“æŸï¼Œæ¢å¤æŒ‰é’®çŠ¶æ€
                btn.disabled = false;
                btn.innerText = "å¼€å§‹æ‰§è¡ŒæŠ“å–ä»»åŠ¡";
            });
    }
</script>

</body>
</html>